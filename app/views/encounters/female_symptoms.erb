<script>
    var tt_cancel_destination = "/patient/dashboard/<%= @patient.id %>/tasks"
    var symptoms_values = [];

    function setConceptNamesAndValues(symptoms, observations, obs_type){

        var values_string = selectedValue(observations);

        /* clear the fields*/
        for (var index = 0; index < symptoms.length; index++){
            var concept_name        = obs_type + index +"_concept_name";
            var value_coded_or_text = obs_type + index +"_value_coded_or_text";

            if(values_string.contains(symptoms[index][0]) && symptoms[index][1] != ""){
                $(concept_name).value         = symptoms[index][1];
                $(value_coded_or_text).value  = 'YES';
            }
            else{
                $(concept_name).value         = '';
                $(value_coded_or_text).value  = '';
            }
        }
    }
    var danger_signs;
    function setInitialDangerSigns() {
        danger_signs = __$('touchscreenInput' + tstCurrentPage).value;
    }
    function getInitialDangerSigns() {
        alert(danger_signs);
        __$('touchscreenInput' + tstCurrentPage).value = danger_signs;
        return danger_signs;
    }
</script>

<style>
    #num{
        display: none;
    }
</style>

<%= render :partial => 'patient/birthdate/button_footer' %>

<%= form_tag("/encounters/create", id: "pregnancy-status", method: 'post', enctype: 'multipart/form-data') do %>
    <%= hidden_field_tag "encounter[encounter_type]", EncounterType.find_by_name("MATERNAL HEALTH SYMPTOMS").id %>
    <%= hidden_field_tag "encounter[patient_id]", @patient.id %>
    <%= hidden_field_tag "encounter[encounter_datetime]", (session_date || DateTime.now()).to_s(:db) %>
    <%= hidden_field_tag "encounter[provider_id]", session[:user_id] %>

    <%= hidden_field_tag("observations[][concept_name]", "Maternal Health Symptoms") %>
    <%= select_tag "observations[][value_coded_or_text_multiple]", options_for_select(@maternal_health_symptoms , nil),
                   :helpText =>"Experiencing any of the following symptoms?",
                   :multiple => true,
                   :tt_pageStyleClass => 'longSelectList',
                   :id => "maternal_health_symptoms",
                   :allowFreeText => false
    %>


    <%= hidden_field_tag("observations[][concept_name]", "Danger signs") %>
    <%= select_tag "observations[][value_coded_or_text_multiple]", options_for_select(@danger_signs , nil),
                   :helpText =>"Select danger signs",
                   :multiple => true,
                   :optional => false,
                   :tt_pageStyleClass => 'longSelectList',
                   :id => "danger_status",
                   :allowFreeText => false
    %>

    <%= hidden_field_tag("observations[][concept_name]", "Maternal health info") %>
    <%= select_tag "observations[][value_coded_or_text_multiple]", options_for_select(@maternal_health_info , nil),
                   :helpText =>"Does the caller want more information from below?",
                   :multiple => true,
                   :tt_pageStyleClass => 'longSelectList',
                   :id => "more_info_topics",
                   :allowFreeText => false
    %>
    <% if false %>
    <%= hidden_field_tag("observations[][concept_name]", "Maternal health info") %>
    <%= select_tag "Additional Danger signs", options_for_select(@danger_signs , nil),
                   :helpText =>"Select additional danger signs",
                   :multiple => true,
                   :tt_onLoad => "$('keyboard').style.display = 'none'; $('inputFrame'+tstCurrentPage).style.height = '90%'; $('viewport').style.height = '90%'; getInitialDangerSigns();",
                   :id => "additional_danger_signs",
                   :allowFreeText => false
    %>



    <% end %>
<% end %>
